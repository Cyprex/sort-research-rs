TODO swap in-place with pointers.
